"use strict";(self.webpackChunkuuboyscy_engineering_logs=self.webpackChunkuuboyscy_engineering_logs||[]).push([[4586],{76260:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"Python/Pandas/PandaSQL","title":"PandaSQL","description":"Create CSV files","source":"@site/docs/Python/Pandas/16_PandaSQL.md","sourceDirName":"Python/Pandas","slug":"/Python/Pandas/PandaSQL","permalink":"/docs/Python/Pandas/PandaSQL","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"groupby.cumcount (partition by row)","permalink":"/docs/Python/Pandas/Cumcount"},"next":{"title":"PyMySQL","permalink":"/docs/Python/Pandas/PyMySQL"}}');var s=t(74848),d=t(28453);const i={},l="PandaSQL",c={},r=[{value:"Create CSV files",id:"create-csv-files",level:2},{value:"Install and import packages",id:"install-and-import-packages",level:2},{value:"Read CSV as DataFeame",id:"read-csv-as-datafeame",level:2},{value:"Execute SQL on DataFrame",id:"execute-sql-on-dataframe",level:2},{value:"Sample code",id:"sample-code",level:3},{value:"ROW_NUMBER()",id:"row_number",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"pandasql",children:"PandaSQL"})}),"\n",(0,s.jsx)(n.h1,{id:"preset",children:"Preset"}),"\n",(0,s.jsx)(n.h2,{id:"create-csv-files",children:"Create CSV files"}),"\n",(0,s.jsx)(n.p,{children:"staff.csv"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ID,Name,DeptId,Age,Gender,Salary,UpdateDate\n001,Mike,002,45,M,60000,2020-12-08\n002,Judy,002,30,F,48000,2021-05-30\n003,Allen,001,22,M,50000,2020-12-08\n004,Tom,002,47,M,47000,2022-05-02\n005,Jack,003,36,M,52000,2022-04-25\n006,Abby,002,24,F,45000,2022-03-03\n007,Trump,001,80,M,80000,2021-09-01\n008,Marry,003,29,F,87000,2022-05-03\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"staff_detail.csv"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ID,Level,UpdateDate\n001,A,2019-08-09\n001,S,2020-12-08\n002,A,2021-05-30\n003,A,2018-03-26\n003,S,2020-12-08\n004,A,2022-05-02\n005,A,2019-11-05\n005,S,2022-04-25\n006,A,2022-03-03\n007,A,2017-03-29\n007,S,2018-05-02\n007,M,2021-09-01\n008,A,2018-11-26\n008,S,2020-03-15\n008,M,2022-05-03\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"install-and-import-packages",children:"Install and import packages"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install pandasql\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(55046).A+"",width:"1602",height:"172"})}),"\n",(0,s.jsx)(n.h1,{id:"pandasqlsqldf",children:"pandasql.sqldf"}),"\n",(0,s.jsx)(n.h2,{id:"read-csv-as-datafeame",children:"Read CSV as DataFeame"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(88839).A+"",width:"1594",height:"1774"})}),"\n",(0,s.jsx)(n.h2,{id:"execute-sql-on-dataframe",children:"Execute SQL on DataFrame"}),"\n",(0,s.jsx)(n.h3,{id:"sample-code",children:"Sample code"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(86188).A+"",width:"1594",height:"662"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(22101).A+"",width:"1590",height:"594"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(98330).A+"",width:"1590",height:"1076"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(46083).A+"",width:"2996",height:"1662"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(9224).A+"",width:"1594",height:"1074"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(19441).A+"",width:"1590",height:"1066"})}),"\n",(0,s.jsx)(n.h3,{id:"row_number",children:"ROW_NUMBER()"}),"\n",(0,s.jsx)(n.p,{children:"Select the highest price of each author. All fields should be kept in the result table."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'columns = ["article", "author", "price"]\ndata = [\n    ["0001", "B", 3.99],\n    ["0002", "A", 10.99],\n    ["0003", "C", 1.69],\n    ["0004", "B", 19.95],\n    ["0005", "A", 6.96],\n]\nprticle_price_df = pd.DataFrame(data=data, columns=columns)\nprticle_price_df\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'sql = """\nwith tmp_prticle_price_df as (\n    select\n        *,\n        ROW_NUMBER() OVER (PARTITION BY author ORDER BY price DESC) as ROW_ID\n    from prticle_price_df\n)\nselect\n    article,\n    author,\n    price\nfrom tmp_prticle_price_df\nwhere ROW_ID = 1\n"""\nsqldf(\n    sql,\n)\n'})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},88839:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 1-22775d4381eee622ec470301a9b400b3.png"},86188:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 2-bb9d53a1f704c4940adafb5d1ca31387.png"},22101:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 3-659611edb82f38ea0966f6f762567576.png"},98330:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 4-462ecdfb325bef1b81a5282e572865bf.png"},46083:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 5-7b0a11a4484c962e206d547e5b8db851.png"},9224:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 6-908bd5ca800c33807ddf678c81082619.png"},19441:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled 7-1ee1d781a1afde58841db642407988c5.png"},55046:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Untitled-99a603f224fedb0bcc04942bf5fd88f4.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var a=t(96540);const s={},d=a.createContext(s);function i(e){const n=a.useContext(d);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(d.Provider,{value:n},e.children)}}}]);